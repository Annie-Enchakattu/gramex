url:
    auth/logout:
        pattern: /$YAMLURL/logout
        handler: LogoutHandler
        kwargs:
            log:
                fields: [session.id, session.user.email, request.remote_ip, request.headers.User-Agent]
            redirect:
                query: next
                url: /$YAMLURL

    auth/google:
        pattern: /$YAMLURL/google
        handler: GoogleAuth
        kwargs:
            # Credentials for s.anand/gramex-guide
            # https://console.developers.google.com/apis/credentials/oauthclient/817932882244-gdr59t3mpqh5554d1bgdjuh38g6a7ahh.apps.googleusercontent.com?project=gramex-guide
            # callback: /auth/google on localhost:9988/, localhost:9999/, learn.gramener.com/guide/
            key: 817932882244-gdr59t3mpqh5554d1bgdjuh38g6a7ahh.apps.googleusercontent.com
            secret: lwArXkw21KCqDPuJrel-WeQO
            log:
                fields: [session.id, session.user.email, request.remote_ip, request.headers.User-Agent]
            redirect:
                query: next
                url: /$YAMLURL

    auth/facebook:
        pattern: /$YAMLURL/facebook
        handler: FacebookAuth
        kwargs:
            # https://developers.facebook.com/apps/794214110679951/settings/
            # callback: localhost:9988
            key: '794214110679951'
            secret: a026887ed94aef25f2f637bf154349df
            log:
                fields: [session.id, session.user.name, request.remote_ip, request.headers.User-Agent]
            redirect:
                query: next
                url: /$YAMLURL

    auth/twitter:
        pattern: /$YAMLURL/twitter
        handler: TwitterAuth
        kwargs:
            # https://apps.twitter.com/app/12449610/keys
            # callback: 127.0.0.1:9988/auth/twitter
            key: XkCVNZD5sfWECxHGAGnlHGQFa
            secret: yU00bx5dHYMbge9IyO5H1KeC5uFnWndntG7u6CH6O4HDZHQg0p
            log:
                fields: [session.id, session.user.username, request.remote_ip, request.headers.User-Agent]
            redirect:
                query: next
                url: /$YAMLURL

    auth/ldap:
        pattern: /$YAMLURL/ldap                 # Map this URL
        handler: LDAPAuth                       # to the LDAP auth handler
        kwargs:
            template: $YAMLPATH/ldap.html       # This has the login form
            host: ipa.demo1.freeipa.org         # Server to connect to
            use_ssl: true                       # Whether to use SSL or not
            user: 'uid={user},cn=users,cn=accounts,dc=demo1,dc=freeipa,dc=org'
            password: '{password}'
            log:
                fields: [session.id, session.user.email, request.remote_ip, request.headers.User-Agent]
            redirect:
                query: next
                url: /$YAMLURL
                external: true

    auth/ldap2:
        pattern: /$YAMLURL/ldap2
        handler: LDAPAuth
        kwargs:
            template: $YAMLPATH/ldap.html
            host: ldap.forumsys.com
            use_ssl: false
            user: 'uid={user},dc=example,dc=com'
            password: '{password}'
            redirect:
                query: next
                url: /$YAMLURL
                external: true

    auth/user:
        pattern: /$YAMLURL/user
        handler: FunctionHandler
        kwargs:
            function: json.dumps
            args: =handler.session['user']
            kwargs:
                indent: 4
            headers:
                Content-Type: application/json

    auth/session:
        pattern: /$YAMLURL/session
        handler: FunctionHandler
        kwargs:
            function: authutil.store_value
            headers:
                Content-Type: application/json

    auth/must-login:
        pattern: /$YAMLURL/must-login
        handler: FileHandler
        kwargs:
            path: $YAMLPATH/secret.html
            auth: true

    auth/dotcom:
        pattern: /$YAMLURL/dotcom
        handler: FileHandler
        kwargs:
            path: $YAMLPATH/secret.html
            auth:
                condition:                          # Allow only if condition is true
                    function: six.text_type.endswith              # Call this function
                    args: [=handler.session.user.email, '.com']   # with these 2 arguments
    auth/dotorg:
        pattern: /$YAMLURL/dotorg
        handler: FileHandler
        kwargs:
            path: $YAMLPATH/secret.html
            auth:
                condition:                          # Allow only if condition is true
                    function: six.text_type.endswith              # Call this function
                    args: [=handler.session.user.email, '.org']   # with these 2 arguments

    auth/en-male:
        pattern: /$YAMLURL/en-male
        handler: FileHandler
        kwargs:
            path: $YAMLPATH/secret.html
            auth:
            auth:
                membership:           # The following user object keys must match
                    gender: male      # user.gender must be male
                    locale: [en, es]  # user.locale must be en or es
